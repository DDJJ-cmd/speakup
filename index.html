<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="SpeakUp" />
  <meta name="theme-color" content="#0b1220" />

  <title>SpeakUp</title>

  <style>
    :root{
      --bg:#0b1220;
      --line:rgba(255,255,255,.10);
      --text:#e9eefc;
      --muted:#9ab0d6;
      --accent1:rgba(110,231,255,.18);
      --accent2:rgba(124,255,166,.14);
      --btn:linear-gradient(90deg,var(--accent1),var(--accent2));
      --shadow:0 10px 40px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
    }
    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:22px 16px 92px;
    }

    /* Newspaper-like title */
    .title{
      text-align:center;
      margin:8px 0 10px;
      font-family:"Times New Roman", Times, Georgia, serif;
      font-weight:800;
      letter-spacing:.6px;
      font-size:36px;
    }

    .topRow{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      margin:10px 0 12px;
    }
    .pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:10px 12px;
      border-radius:999px;
      color:var(--muted);
      font-size:13px;
    }
    .pill strong{ color:var(--text); font-weight:800; }

    .pill select{
      border:1px solid var(--line);
      background:rgba(0,0,0,.18);
      color:var(--text);
      border-radius:999px;
      padding:8px 10px;
      outline:none;
      font-weight:800;
      max-width:520px;
      appearance:none;
      -webkit-appearance:none;
      -moz-appearance:none;
    }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:14px;
      box-shadow:var(--shadow);
      margin:12px 0;
    }
    .card h2{
      margin:0 0 10px;
      font-size:16px;
      letter-spacing:.2px;
    }
    .small{
      font-size:12px;
      color:var(--muted);
      line-height:1.4;
    }

    .btn{
      width:100%;
      padding:14px;
      border-radius:14px;
      border:1px solid var(--line);
      background:var(--btn);
      color:#fff;
      font-weight:900;
      font-size:16px;
      cursor:pointer;
    }
    .btn:active{ transform:translateY(1px); }
    .btnSec{
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text);
      cursor:pointer;
      white-space:nowrap;
    }

    .kwItem{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      border-radius:14px;
      padding:12px;
      margin:10px 0;
    }
    .kwTop{
      display:flex;
      gap:10px;
      align-items:baseline;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .kwTop .kw{
      font-weight:900;
      font-size:14px;
    }
    .kwTop .ja{
      color:var(--muted);
      font-size:12px;
      font-weight:600;
    }
    .uses{
      margin-top:8px;
      font-size:12px;
      color:#cfe0ff;
      line-height:1.5;
      white-space:pre-line;
    }

    textarea{
      width:100%;
      min-height:220px;
      resize:vertical;
      padding:12px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.22);
      color:var(--text);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      line-height:1.45;
      outline:none;
    }

    /* Tabs */
    .tabs{
      position:fixed;
      left:0; right:0; bottom:0;
      padding:10px 10px calc(10px + env(safe-area-inset-bottom));
      background:linear-gradient(180deg, rgba(11,18,32,.0), rgba(11,18,32,.9) 30%, rgba(11,18,32,.98));
      backdrop-filter: blur(10px);
    }
    .tabRow{
      max-width:1100px;
      margin:0 auto;
      display:grid;
      grid-template-columns:1fr 1fr 1fr;
      gap:10px;
    }
    .tabBtn{
      padding:12px 10px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:#cfe0ff;
      font-weight:800;
      cursor:pointer;
    }
    .tabBtn.active{
      background:rgba(255,255,255,.07);
      color:#fff;
    }
    .view{ display:none; }
    .view.active{ display:block; }

    /* Toast */
    .toast{
      position:fixed;
      left:50%;
      bottom:86px;
      transform:translateX(-50%);
      background:rgba(0,0,0,.75);
      border:1px solid rgba(255,255,255,.12);
      color:#fff;
      padding:10px 12px;
      border-radius:999px;
      font-size:12px;
      opacity:0;
      pointer-events:none;
      transition:opacity .18s ease;
    }
    .toast.show{ opacity:1; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="title">SpeakUp</div>

    <div class="topRow">
      <div class="pill">
        状態：<strong id="statusText">未利用</strong>
      </div>
      <div class="pill">
        今日のTopic：<strong id="topicLabel">Topic 1</strong>
      </div>
      <div class="pill">
        日付：<strong id="dateLabel">-</strong>
      </div>
      <div class="pill">
        Topic変更：
        <select id="topicSelect" aria-label="Topic selector"></select>
      </div>
    </div>

    <!-- Today -->
    <div id="viewToday" class="view active">
      <div class="card">
        <h2>Prompts（順番に聞く）</h2>
        <div class="small">質問は1つずつ。回答後に短く添削＆自然な言い換え。</div>
        <div id="promptArea" class="small" style="margin-top:10px; white-space:pre-line;"></div>
      </div>

      <div class="card">
        <h2>Keywords（タップで復習）</h2>
        <div class="small">キーワードを押すとNotes欄に追記される（復習用）。</div>
        <div id="kwList"></div>
      </div>

      <div class="card">
        <h2>Let’s speak up!</h2>
        <div class="small">押すと：お題＋質問＋キーワードをChatGPTに渡して会話開始（履歴も保存）</div>
        <button class="btn" id="speakBtn">Let’s speak up!</button>
      </div>

      <div class="card">
        <h2>Notes保存用（いつでも復習）</h2>
        <div class="small">下は自由。コピーしてNotes/Notionへ。ショートカット連携もここからOK。</div>
        <textarea id="notesArea" placeholder="- keyword = 日本語訳&#10;uses: Example 1 / Example 2 / Example 3&#10;&#10;[Chat Memo（会話の要点）]&#10;-"></textarea>
        <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btnSec" id="copyNotesBtn">コピー</button>
          <button class="btnSec" id="clearNotesBtn">クリア</button>
        </div>
      </div>
    </div>

    <!-- History -->
    <div id="viewHistory" class="view">
      <div class="card">
        <h2>History</h2>
        <div class="small">直近20件（端末内保存 / localStorage）</div>
        <div id="historyArea" class="small" style="margin-top:10px; white-space:pre-line;"></div>
      </div>
    </div>

    <!-- Settings -->
    <div id="viewSettings" class="view">
      <div class="card">
        <h2>Settings</h2>
        <div class="small">最低限。必要なら後で拡張。</div>

        <h2 style="margin-top:14px;">データ</h2>
        <button class="btnSec" id="resetAllBtn">全データ初期化（注意）</button>
        <div class="small" style="margin-top:8px;">
          ※Notes・履歴・利用状態を削除します
        </div>
      </div>
    </div>
  </div>

  <div class="tabs">
    <div class="tabRow">
      <button class="tabBtn active" id="tab1">Today</button>
      <button class="tabBtn" id="tab2">History</button>
      <button class="tabBtn" id="tab3">Settings</button>
    </div>
  </div>

  <div class="toast" id="toast"></div>

<script>
/* =========================
   SpeakUp：HMJ専用 30 Topics（完全実装）
   ========================= */
const TOPICS = [
  {
    title: "Monthly Performance Story (Budget vs Actual)",
    guide: "Budgetベースで月次のギャップ要因と次の打ち手を英語で説明する。",
    prompts: [
      "What were the key drivers of the gap versus budget this month?",
      "Which department contributed most to the variance and why?",
      "What actions will you take next month to close the gap?",
      "How confident are you in the current forecast, and what risks remain?"
    ],
    keywords: [
      { en:"variance", ja:"差異", uses:"We saw a negative variance versus budget. / Please explain the main variance drivers. / The variance narrowed in the second half." },
      { en:"driver", ja:"要因", uses:"The primary driver was ADR softness. / Labor cost was another key driver. / We need to isolate the real drivers." },
      { en:"mitigation", ja:"対策", uses:"We have mitigation actions in place. / Mitigation will focus on cost containment. / Revenue mitigation is limited in low season." },
      { en:"forecast confidence", ja:"予測の確度", uses:"Our forecast confidence is moderate. / Confidence improved after pickup trends stabilized. / Low visibility reduces forecast confidence." },
      { en:"headwind", ja:"逆風要因", uses:"Weak demand is a headwind. / OTA mix is a headwind to ADR. / Weather can be a short-term headwind." }
    ]
  },
  {
    title: "Flow-Through Diagnosis (ADR-led vs OCC-led)",
    guide: "Flow-throughの良化/悪化をADR主導かOCC主導かで切り分けて話す。",
    prompts: [
      "Is the revenue change driven more by ADR or occupancy? How do you know?",
      "Which variable costs moved with volume (CPOR) and impacted flow-through?",
      "What fixed costs prevented margin recovery even when revenue improved?",
      "What would you monitor weekly to prevent flow-through deterioration?"
    ],
    keywords: [
      { en:"flow-through", ja:"増収利益率", uses:"Flow-through deteriorated due to higher variable costs. / We target higher flow-through on ADR-led growth. / Flow-through is below expectation." },
      { en:"ADR-led", ja:"ADR主導", uses:"ADR-led growth usually improves margin. / This month was not ADR-led. / We aim for ADR-led recovery." },
      { en:"OCC-led", ja:"稼働率主導", uses:"OCC-led growth can increase variable costs. / OCC-led pickup hurt flow-through. / OCC-led demand requires cost discipline." },
      { en:"variable cost", ja:"変動費", uses:"Variable costs rose with rooms sold. / Identify variable cost leakage. / Variable costs should scale predictably." },
      { en:"CPOR", ja:"販売客室数あたり変動費", uses:"CPOR increased mainly from linen and amenities. / CPOR is a good early warning metric. / We need to stabilize CPOR." }
    ]
  },
  {
    title: "ADR Strategy and Rate Integrity",
    guide: "割引/クーポン/レートミックスの観点でADRを守る議論をする。",
    prompts: [
      "What is your ADR protection strategy in a soft-demand period?",
      "How do discounts and coupons affect rate integrity and long-term ADR?",
      "Which segments can you shift to improve ADR without losing volume?",
      "How do you coordinate revenue decisions with Sales & Marketing?"
    ],
    keywords: [
      { en:"rate integrity", ja:"レート整合性", uses:"We need to protect rate integrity. / Rate integrity is at risk with aggressive discounts. / Rate integrity supports long-term positioning." },
      { en:"discount dependency", ja:"値引き依存", uses:"Discount dependency is risky. / We should reduce discount dependency. / Discount dependency lowers long-term ADR." },
      { en:"rate mix", ja:"レート構成", uses:"Rate mix shifted to lower-paying channels. / We need a healthier rate mix. / Rate mix impacts profit quality." },
      { en:"segmentation", ja:"セグメント設計", uses:"Segmentation helps us target the right guests. / We refined segmentation by purpose of stay. / Segmentation supports pricing decisions." },
      { en:"fence", ja:"条件設定（レートフェンス）", uses:"We added fences to protect higher rates. / Fence design reduces abuse. / Strong fences improve ADR." }
    ]
  },
  {
    title: "Occupancy Management and Pickup Control",
    guide: "Pickup推移と制限（LOS/CTA/CTD）でOCCを制御する話をする。",
    prompts: [
      "How did pickup evolve in the last two weeks, and what changed?",
      "What restrictions did you apply (LOS, CTA/CTD) and why?",
      "Which channels drove occupancy, and what was the profitability impact?",
      "How do you balance occupancy targets with margin protection?"
    ],
    keywords: [
      { en:"pickup", ja:"予約積み上がり", uses:"Pickup improved after the campaign launch. / Pickup slowed in midweek. / We monitor pickup daily." },
      { en:"LOS", ja:"最低宿泊数", uses:"We applied LOS to peak dates. / LOS helps protect high-demand nights. / LOS can reduce low-value bookings." },
      { en:"CTA/CTD", ja:"到着/出発制限", uses:"CTA was used to manage shoulder nights. / CTD protects peak arrivals. / Use CTA/CTD carefully to avoid lost demand." },
      { en:"inventory control", ja:"在庫コントロール", uses:"Inventory control supports rate optimization. / We tightened inventory for premium rooms. / Inventory control affects channel behavior." },
      { en:"compression", ja:"需要集中", uses:"Compression supports higher pricing. / There is no compression in the market. / Compression periods require discipline." }
    ]
  },
  {
    title: "RevPAR vs GOP: Explaining the Trade-off",
    guide: "RevPARの変化がGOPにどう効いたか（効かなかったか）を説明する。",
    prompts: [
      "How did RevPAR move versus budget and what were the components?",
      "Did higher revenue translate to GOP improvement? Why or why not?",
      "Which costs were most sensitive to volume and reduced GOP leverage?",
      "What is your plan to improve GOP without sacrificing demand?"
    ],
    keywords: [
      { en:"RevPAR", ja:"客室収益指標", uses:"RevPAR declined versus budget. / RevPAR improved on weekends. / RevPAR performance lagged competitors." },
      { en:"leverage", ja:"レバレッジ効果", uses:"We lost operating leverage due to cost inflation. / Leverage improves when fixed costs are stable. / We need better leverage on revenue growth." },
      { en:"conversion", ja:"利益転換", uses:"Revenue conversion to GOP was weaker. / Conversion improved after cost controls. / Monitor conversion by department." },
      { en:"cost inflation", ja:"コスト上昇", uses:"Cost inflation pressured margins. / Inflation hit utilities and supplies. / Inflation requires repricing and efficiency." },
      { en:"profit quality", ja:"利益の質", uses:"Profit quality deteriorated due to OTA mix. / We focus on profit quality, not just volume. / Profit quality matters for long-term strategy." }
    ]
  },
  {
    title: "Rooms Department Profit Deep Dive",
    guide: "Rooms利益をRate/Volume/MixとCPORの観点で深掘りする。",
    prompts: [
      "What drove rooms department profit versus budget (rate, volume, mix)?",
      "How did housekeeping, linen, and amenities costs move with volume?",
      "What actions can reduce CPOR without hurting guest experience?",
      "How do you align front office and housekeeping to improve efficiency?"
    ],
    keywords: [
      { en:"department profit", ja:"部門利益", uses:"Rooms department profit missed budget. / Department profit improved with higher ADR. / We need to protect department profit." },
      { en:"mix", ja:"ミックス", uses:"Mix shifted to lower-rated segments. / Mix improvement helped ADR. / Mix changes explain half of the variance." },
      { en:"linen", ja:"リネン費", uses:"Linen cost increased per occupied room. / We need linen cost controls. / Linen usage policy affects CPOR." },
      { en:"amenities", ja:"アメニティ", uses:"Amenity cost rose due to higher usage. / We should standardize amenities. / Amenities must balance cost and brand." },
      { en:"productivity", ja:"生産性", uses:"Productivity improved after scheduling changes. / We track productivity per room cleaned. / Productivity is key for margin." }
    ]
  },
  {
    title: "F&B Profitability and Cost Control",
    guide: "料飲の売上・原価・人件費・メニュー施策を英語で整理して話す。",
    prompts: [
      "Which outlets performed best and what drove the results?",
      "How did food cost and beverage cost compare to targets?",
      "What menu engineering actions will you take to improve margin?",
      "How do you manage staffing flexibly while maintaining service?"
    ],
    keywords: [
      { en:"food cost", ja:"食材原価", uses:"Food cost was higher due to waste. / Food cost improved after menu changes. / We need stricter food cost controls." },
      { en:"menu engineering", ja:"メニュー最適化", uses:"Menu engineering focuses on high-margin items. / We will redesign the menu mix. / Menu engineering supports profitability." },
      { en:"waste", ja:"廃棄", uses:"Waste increased due to low covers. / We reduced waste with prep controls. / Waste tracking is essential." },
      { en:"covers", ja:"客数", uses:"Covers declined midweek. / Covers improved with group business. / Covers drive labor scheduling." },
      { en:"labor flexibility", ja:"人員の柔軟運用", uses:"Labor flexibility helps protect margin. / We cross-train staff for flexibility. / Flexibility prevents overstaffing." }
    ]
  },
  {
    title: "Banquet & MICE: Booking Pace and Profit",
    guide: "宴会の予約ペースと利益構造（単価・原価・人件費）を説明する。",
    prompts: [
      "How is booking pace trending for the next 90 days?",
      "Which segments (weddings, corporate, social) are driving demand?",
      "What is the margin profile by event type and why?",
      "How do you manage labor and outsourcing for banquet operations?"
    ],
    keywords: [
      { en:"booking pace", ja:"予約ペース", uses:"Booking pace is behind plan. / Pace improved after sales blitz. / Track booking pace weekly." },
      { en:"pipeline", ja:"案件パイプライン", uses:"The pipeline is healthy for Q2. / Pipeline quality matters more than quantity. / We need stronger pipeline conversion." },
      { en:"conversion rate", ja:"成約率", uses:"Conversion rate dropped due to pricing. / Improve conversion rate with packages. / Conversion rate is a key KPI." },
      { en:"outsourcing", ja:"外注", uses:"Outsourcing costs increased unexpectedly. / We should control outsourcing scope. / Outsourcing helps during peak demand." },
      { en:"function space", ja:"宴会場", uses:"Function space utilization is low. / We can improve space yield. / Space strategy affects banquet profit." }
    ]
  },
  {
    title: "Undistributed Expenses: Utilities & POM",
    guide: "Utilities/POMの増減要因と、月次の予測と対策を英語で話す。",
    prompts: [
      "What caused utilities to move versus budget (weather, usage, rates)?",
      "Which POM items were one-time vs recurring?",
      "What preventive maintenance can reduce cost volatility?",
      "How do you track and forecast undistributed expenses monthly?"
    ],
    keywords: [
      { en:"undistributed expenses", ja:"非配賦費用", uses:"Undistributed expenses were well controlled. / They remain elevated due to utilities. / We need a plan to manage undistributed expenses." },
      { en:"utilities", ja:"光熱費", uses:"Utilities increased due to higher consumption. / Utilities were lower after optimization. / Utilities are sensitive to occupancy and weather." },
      { en:"POM", ja:"施設管理・修繕", uses:"POM had one-time repairs. / POM forecast needs better visibility. / POM spend is front-loaded this quarter." },
      { en:"one-time", ja:"一過性", uses:"This cost is one-time, not structural. / Separate one-time from recurring items. / One-time expenses distort trend analysis." },
      { en:"preventive maintenance", ja:"予防保全", uses:"Preventive maintenance reduces breakdown risk. / It helps stabilize POM costs. / We need a preventive maintenance plan." }
    ]
  },
  {
    title: "Sales & Marketing Spend vs ROI (OTA Focus)",
    guide: "S&Mの費用対効果を、OTA施策とネット収益の観点で説明する。",
    prompts: [
      "What S&M activities drove bookings and what is the ROI?",
      "How did OTA promotions affect ADR and net revenue?",
      "Which channels should receive more budget next month and why?",
      "How do you evaluate marketing effectiveness without over-discounting?"
    ],
    keywords: [
      { en:"ROI", ja:"投資対効果", uses:"ROI is unclear without tracking. / We need ROI by campaign. / ROI improved after targeting the right segment." },
      { en:"net ADR", ja:"純ADR", uses:"Net ADR fell due to commissions. / Focus on net ADR, not just headline ADR. / Net ADR reflects true profitability." },
      { en:"commission", ja:"手数料", uses:"Commission costs increased. / Commission impacts net revenue. / Commission control is critical for profit." },
      { en:"promotion", ja:"販促", uses:"Promotion boosted volume but diluted rate. / Promotions should be time-boxed. / Promotion strategy must protect brand." },
      { en:"attribution", ja:"効果測定", uses:"Attribution is difficult across channels. / We need better attribution tracking. / Attribution informs budget allocation." }
    ]
  },
  {
    title: "Forecast Review: Risks, Assumptions, and Sensitivity",
    guide: "Forecastの前提・リスク・感応度（ADR/OCC）を英語で議論する。",
    prompts: [
      "What are the key assumptions behind your forecast this month?",
      "Which risks could cause downside, and what are early indicators?",
      "What is your sensitivity to ADR and occupancy changes?",
      "How will you update the forecast based on pickup trends?"
    ],
    keywords: [
      { en:"assumption", ja:"前提", uses:"Assumptions are conservative. / We need to validate key assumptions. / Assumptions changed after market updates." },
      { en:"downside risk", ja:"下振れリスク", uses:"Downside risk is demand softness. / Identify downside risk triggers. / We prepared mitigation for downside risk." },
      { en:"sensitivity", ja:"感応度", uses:"Sensitivity to ADR is high. / Run sensitivity scenarios. / Sensitivity analysis supports decisions." },
      { en:"scenario", ja:"シナリオ", uses:"We prepared base, upside, and downside scenarios. / Scenario planning improves readiness. / Use scenarios to align stakeholders." },
      { en:"visibility", ja:"見通し", uses:"Visibility is low in the market. / Visibility improved after event confirmation. / Low visibility requires cautious forecasting." }
    ]
  },
  {
    title: "Explaining a Reforecast (Why Numbers Changed)",
    guide: "前回予測からの変更点を、再掲ではなくロジックで説明する。",
    prompts: [
      "What changed since the last forecast submission?",
      "Which line items moved structurally vs temporarily?",
      "How did the updated forecast impact GOP commitment?",
      "What actions are reflected in this reforecast (not just restatement)?"
    ],
    keywords: [
      { en:"reforecast", ja:"再予測", uses:"We submitted a reforecast based on updated pickup. / Reforecast reflects new assumptions. / Reforecast includes mitigation actions." },
      { en:"restatement", ja:"単なる言い換え", uses:"This is not a restatement; it includes actions. / Avoid restatement without strategy. / We need action-based forecasting." },
      { en:"commitment", ja:"コミット", uses:"We remain committed to GOP targets. / Commitment requires cost discipline. / Commitment level depends on visibility." },
      { en:"structural", ja:"構造的", uses:"This is a structural issue, not one-time. / Identify structural cost creep. / Structural changes need long-term solutions." },
      { en:"temporary", ja:"一時的", uses:"The impact is temporary. / Temporary costs should be separated. / Temporary effects can reverse next month." }
    ]
  },
  {
    title: "Labor Cost Control Without Hurting Service",
    guide: "人件費を守りつつ、サービス品質を落とさない運用を英語で話す。",
    prompts: [
      "Where did labor hours exceed plan and why?",
      "What scheduling changes can improve productivity next month?",
      "How do you use cross-training to increase flexibility?",
      "What service metrics will you monitor to avoid guest impact?"
    ],
    keywords: [
      { en:"productivity", ja:"生産性", uses:"Productivity improved after roster optimization. / We track productivity weekly. / Productivity is critical for margin." },
      { en:"roster", ja:"シフト表", uses:"Roster planning needs better demand signals. / We adjusted the roster to pickup. / Roster discipline prevents overspend." },
      { en:"cross-training", ja:"多能工化", uses:"Cross-training improves flexibility. / We expanded cross-training across outlets. / Cross-training reduces overtime." },
      { en:"overtime", ja:"残業", uses:"Overtime increased due to last-minute events. / We need overtime controls. / Overtime should be exception-based." },
      { en:"service level", ja:"サービス水準", uses:"We must maintain service level. / Service level dropped due to understaffing. / Balance service level and cost." }
    ]
  },
  {
    title: "Payroll vs Profit: Managing Trade-offs",
    guide: "Payroll投入が利益にどう効くかを部門別に説明し、改善案を話す。",
    prompts: [
      "How does labor investment translate into profit by department?",
      "Where are we over-investing relative to revenue opportunity?",
      "What KPIs indicate efficient staffing (e.g., covers per labor hour)?",
      "What changes can improve profit without increasing headcount?"
    ],
    keywords: [
      { en:"labor investment", ja:"人件費投資", uses:"Labor investment must be tied to demand. / Investment should improve output. / We need smarter labor investment." },
      { en:"efficiency", ja:"効率", uses:"Efficiency improved after process changes. / Efficiency varies by department. / We measure efficiency with output-based KPIs." },
      { en:"output", ja:"成果", uses:"Output per labor hour improved. / Output should justify staffing levels. / Focus on output, not just hours." },
      { en:"headcount", ja:"人員数", uses:"Headcount is stable but hours increased. / We can reduce headcount growth with automation. / Headcount planning needs discipline." },
      { en:"KPI linkage", ja:"KPI連動", uses:"KPI linkage helps justify staffing. / Strengthen KPI linkage to payroll. / Use KPI linkage for planning." }
    ]
  },
  {
    title: "Guest Mix and Channel Strategy",
    guide: "客層/チャネルのミックスが利益の質に与える影響を英語で説明する。",
    prompts: [
      "How did guest mix change and how did it impact revenue quality?",
      "Which channels are healthiest for net revenue and why?",
      "What actions can shift mix toward higher-profit segments?",
      "How do you manage channel conflict with OTAs and direct?"
    ],
    keywords: [
      { en:"guest mix", ja:"客層ミックス", uses:"Guest mix shifted to price-sensitive segments. / Guest mix improved on weekends. / Guest mix impacts revenue quality." },
      { en:"channel strategy", ja:"チャネル戦略", uses:"Channel strategy must protect net revenue. / We need a clearer channel strategy. / Channel strategy affects long-term positioning." },
      { en:"direct bookings", ja:"直販", uses:"Direct bookings are healthier. / We want to grow direct bookings share. / Direct bookings reduce commission cost." },
      { en:"rate parity", ja:"レートパリティ", uses:"Rate parity issues can harm trust. / Keep rate parity across channels. / Rate parity supports brand integrity." },
      { en:"net revenue", ja:"純売上", uses:"Net revenue declined due to commission. / Track net revenue by channel. / Net revenue is the real metric." }
    ]
  },
  {
    title: "Coupon Impact and OTA Dilution",
    guide: "OTAクーポンの影響をADR/純売上/Rooms利益で定量的に説明する。",
    prompts: [
      "How did coupon usage trend and what drove the increase?",
      "What is the net impact on ADR and rooms profit?",
      "How will you redesign promotions to protect rate integrity?",
      "What governance do you need for future coupon approvals?"
    ],
    keywords: [
      { en:"coupon usage", ja:"クーポン利用", uses:"Coupon usage exceeded expectation. / We need limits on coupon usage. / Coupon usage drives ADR dilution." },
      { en:"ADR dilution", ja:"ADR希薄化", uses:"ADR dilution came from discounting. / We must control ADR dilution. / ADR dilution hurts rooms profit." },
      { en:"governance", ja:"統制", uses:"We need governance for promotions. / Governance prevents uncontrolled discounting. / Strong governance protects profitability." },
      { en:"approval process", ja:"承認プロセス", uses:"Approval process should be clear. / We tightened the approval process. / Approval process reduces risk." },
      { en:"net impact", ja:"純影響", uses:"Net impact is negative after commissions. / Always evaluate net impact. / Net impact differs by channel." }
    ]
  },
  {
    title: "Cost Containment Plan (Next Forecast Submission)",
    guide: "次回提出でGOPマイナスを取り返すためのコスト施策を英語で話す。",
    prompts: [
      "Which costs have the biggest impact on GOP variance?",
      "What specific actions will you implement before next submission?",
      "What is the expected savings and timeline for each action?",
      "How will you ensure actions are executed and tracked?"
    ],
    keywords: [
      { en:"cost containment", ja:"コスト抑制", uses:"Cost containment is our priority. / We launched cost containment actions. / Cost containment should not hurt core service." },
      { en:"savings", ja:"削減効果", uses:"Expected savings are ¥X million. / Savings will be phased in. / Track savings versus baseline." },
      { en:"timeline", ja:"実行期限", uses:"Timeline is within this month. / We need a clear timeline. / Timeline discipline matters." },
      { en:"accountability", ja:"責任所在", uses:"Assign accountability to owners. / Accountability ensures execution. / Accountability must be visible." },
      { en:"tracking", ja:"進捗管理", uses:"Tracking is done weekly. / We need better tracking. / Tracking prevents action drift." }
    ]
  },
  {
    title: "Explaining One-time vs Structural Items",
    guide: "一過性と構造的な収益/費用を切り分け、トレンドを正しく語る。",
    prompts: [
      "Which items are one-time and how should we normalize results?",
      "What structural issues must be addressed long-term?",
      "How do these items affect trend interpretation?",
      "How will you prevent one-time items from recurring?"
    ],
    keywords: [
      { en:"normalize", ja:"平準化する", uses:"We normalized results for one-time items. / Normalize to see the real trend. / Normalized GOP is more meaningful." },
      { en:"recurring", ja:"継続的", uses:"This cost is recurring. / Avoid treating recurring costs as one-time. / Recurring items require structural fixes." },
      { en:"root cause", ja:"根本原因", uses:"We need the root cause. / Root cause analysis prevents repeat issues. / Identify root cause quickly." },
      { en:"trend", ja:"トレンド", uses:"Trend is distorted by one-time repairs. / Trend analysis should use normalized numbers. / Trend matters for forecasting." },
      { en:"prevention", ja:"再発防止", uses:"Prevention requires process changes. / Prevention reduces volatility. / Prevention is better than reaction." }
    ]
  },
  {
    title: "KPI Storytelling for GM Letter",
    guide: "GM Letter向けに、KPIで意思決定に繋がるストーリーを作る。",
    prompts: [
      "Which KPIs best explain this month’s performance?",
      "What KPI signals did we miss earlier, and why?",
      "How will you use KPIs to improve decision speed next month?",
      "What KPI dashboard would help GM discussions most?"
    ],
    keywords: [
      { en:"storytelling", ja:"ストーリー化", uses:"KPI storytelling makes insights memorable. / Use KPI storytelling for alignment. / Storytelling clarifies priorities." },
      { en:"leading indicator", ja:"先行指標", uses:"Pickup is a leading indicator. / CPOR can be a leading indicator. / We need stronger leading indicators." },
      { en:"dashboard", ja:"ダッシュボード", uses:"Dashboard should be simple and actionable. / We need a weekly dashboard. / Dashboard reduces manual work." },
      { en:"alignment", ja:"認識合わせ", uses:"We need alignment across hotels. / Alignment improves execution. / KPI alignment helps governance." },
      { en:"actionable", ja:"実行可能", uses:"Make insights actionable. / Actionable KPIs drive behavior. / Actionable does not mean complex." }
    ]
  },
  {
    title: "Hotel Benchmarking and Target Setting (HMJ)",
    guide: "HMJ内ベンチマークを使い、ホテルタイプとADR帯を踏まえて目標設計する。",
    prompts: [
      "Which hotels are best benchmarks for this property and why?",
      "What target KPIs should we set for the next quarter?",
      "How do we adjust benchmarks for hotel type (FS vs SS) and ADR band?",
      "What risks come from copying benchmarks without context?"
    ],
    keywords: [
      { en:"benchmark", ja:"ベンチマーク", uses:"Benchmark against similar hotels. / Benchmarking highlights gaps. / Benchmarking must consider context." },
      { en:"target", ja:"目標値", uses:"Set realistic targets. / Targets must be owned by teams. / Targets should be measurable." },
      { en:"context", ja:"前提条件", uses:"Context matters for interpretation. / Without context, benchmarks mislead. / Context includes segment, location, seasonality." },
      { en:"peer set", ja:"比較対象群", uses:"Define the peer set carefully. / Peer set should be comparable. / Peer set drives fairness." },
      { en:"gap", ja:"ギャップ", uses:"We identified a performance gap. / Close the gap with actions. / Gap analysis supports priorities." }
    ]
  },
  {
    title: "New Hotel Acquisition: Building a Realistic PL",
    guide: "買収ホテルのPLを、KPIドライバーとベンチマークで現実的に作る話をする。",
    prompts: [
      "What KPI drivers do you need to build a realistic PL for a new hotel?",
      "How do you translate benchmarks into cost structure assumptions?",
      "What are the biggest uncertainties in early-stage PL modeling?",
      "How do you present the model limitations to stakeholders?"
    ],
    keywords: [
      { en:"assumption", ja:"前提", uses:"Assumptions must be transparent. / Document key assumptions. / Assumptions drive the model output." },
      { en:"benchmark translation", ja:"ベンチ→前提変換", uses:"Translate benchmarks into assumptions. / Benchmark translation needs hotel type adjustment. / Validate translation with operations." },
      { en:"uncertainty", ja:"不確実性", uses:"Uncertainty is high early on. / We need ranges, not single points. / Uncertainty should be communicated." },
      { en:"model limitation", ja:"モデル限界", uses:"Model limitations must be stated. / Limitations prevent misuse. / Keep limitations visible in presentations." },
      { en:"stakeholder", ja:"関係者", uses:"Stakeholders need clarity. / Align stakeholders on assumptions. / Stakeholder alignment speeds decisions." }
    ]
  },
  {
    title: "Variance Explanation: ADR vs OCC Decomposition",
    guide: "Rooms売上差異をRate/Volumeに分解し、施策に落とす会話をする。",
    prompts: [
      "How would you decompose rooms revenue variance into rate and volume effects?",
      "Which effect was larger this month and why?",
      "How do you use this decomposition to drive actions?",
      "What data quality checks are necessary before presenting results?"
    ],
    keywords: [
      { en:"decomposition", ja:"分解", uses:"Decomposition clarifies the real drivers. / Use decomposition for rate vs volume. / Decomposition supports action planning." },
      { en:"rate effect", ja:"価格差異", uses:"Rate effect was negative due to discounting. / Rate effect improved with better mix. / Rate effect requires pricing strategy." },
      { en:"volume effect", ja:"数量差異", uses:"Volume effect was positive due to group pickup. / Volume effect increased variable costs. / Volume effect needs staffing controls." },
      { en:"data check", ja:"データ検証", uses:"Run data checks before analysis. / Data checks prevent misstatements. / Data checks improve trust." },
      { en:"action planning", ja:"施策立案", uses:"Action planning must follow analysis. / Analysis without action planning is not useful. / Tie action planning to owners and dates." }
    ]
  },
  {
    title: "Rate Strategy for Fusion Group Collaboration",
    guide: "Fusion側とレート戦略を共通言語で議論し、合意形成する。",
    prompts: [
      "What rate positioning do you want to maintain for brand perception?",
      "How do you handle OTA pressure while keeping direct growth?",
      "What data should we share regularly to align on revenue decisions?",
      "How do you resolve disagreements between commercial and operations?"
    ],
    keywords: [
      { en:"positioning", ja:"ポジショニング", uses:"Positioning supports long-term pricing. / Keep positioning consistent. / Positioning matters in competitive markets." },
      { en:"alignment", ja:"方向性の一致", uses:"Alignment across teams is critical. / Alignment improves speed. / Alignment prevents conflicting actions." },
      { en:"data sharing", ja:"データ共有", uses:"Data sharing improves transparency. / Agree on a data sharing cadence. / Data sharing should be standardized." },
      { en:"cadence", ja:"頻度", uses:"Set a weekly cadence. / Cadence creates rhythm. / Cadence keeps teams aligned." },
      { en:"conflict resolution", ja:"対立解消", uses:"Conflict resolution needs clear criteria. / Use profit impact as criteria. / Resolution should be documented." }
    ]
  },
  {
    title: "SOP and Finance: Making Operations Measurable",
    guide: "SOPをKPI化して運用を測れるようにし、現場負荷を増やさず改善する。",
    prompts: [
      "Which SOP steps should be tracked with KPIs and why?",
      "How do you ensure data capture is simple for hotel teams?",
      "What is the best way to audit SOP compliance without friction?",
      "How can finance support operations with practical insights?"
    ],
    keywords: [
      { en:"SOP compliance", ja:"SOP遵守", uses:"SOP compliance improves consistency. / Compliance needs simple tracking. / Audit compliance without blame." },
      { en:"data capture", ja:"データ取得", uses:"Data capture should be lightweight. / Automate data capture where possible. / Bad data capture creates resistance." },
      { en:"audit", ja:"監査/点検", uses:"Audit should be constructive. / Use audits to find improvements. / Audit frequency must be realistic." },
      { en:"friction", ja:"摩擦", uses:"Reduce friction for teams. / Too much friction kills adoption. / Friction can be removed with better UX." },
      { en:"practical insight", ja:"実務的示唆", uses:"Insights must be practical. / Practical insights drive action. / Avoid overly theoretical outputs." }
    ]
  },
  {
    title: "Automation in Reporting (Reducing Manual Work)",
    guide: "PL/KPIレポートの自動化で非属人化し、誤提出を防ぐ話をする。",
    prompts: [
      "Which reporting steps are most repetitive and should be automated first?",
      "How do you ensure the process is not person-dependent?",
      "What error checks do you add to avoid wrong submissions?",
      "How do you communicate automation benefits to stakeholders?"
    ],
    keywords: [
      { en:"automation", ja:"自動化", uses:"Automation reduces manual work. / Automation improves consistency. / Automation needs governance." },
      { en:"non-person-dependent", ja:"非属人化", uses:"We aim for a non-person-dependent process. / Remove hard-coded paths. / Standardize folder structures." },
      { en:"validation", ja:"検証", uses:"Add validation before submission. / Validation prevents errors. / Validation builds trust." },
      { en:"exception handling", ja:"例外対応", uses:"Exception handling is required for edge cases. / Plan exception handling early. / Exceptions should be logged." },
      { en:"stakeholder buy-in", ja:"関係者合意", uses:"Buy-in matters for adoption. / Show quick wins to get buy-in. / Align buy-in with ROI." }
    ]
  },
  {
    title: "Explaining KPI Definitions (Common Language)",
    guide: "KPI定義のズレを洗い出し、共通言語として標準化する会話をする。",
    prompts: [
      "Which KPI definitions are inconsistent across hotels today?",
      "How do you document KPI definitions so everyone aligns?",
      "What is the simplest way to train new members on KPI logic?",
      "How do you handle KPI changes without confusion?"
    ],
    keywords: [
      { en:"definition", ja:"定義", uses:"Definition must be consistent. / Clarify KPI definitions. / Definition changes should be communicated clearly." },
      { en:"documentation", ja:"ドキュメント化", uses:"Documentation prevents confusion. / Keep documentation simple. / Documentation should be searchable." },
      { en:"onboarding", ja:"教育", uses:"Onboarding needs a quick guide. / Improve onboarding with examples. / Onboarding reduces errors." },
      { en:"change management", ja:"変更管理", uses:"Change management prevents chaos. / Communicate changes early. / Log all changes." },
      { en:"standardization", ja:"標準化", uses:"Standardization improves comparability. / Standardization saves time. / Avoid over-standardization where context matters." }
    ]
  },
  {
    title: "Owners’ Questions: Answering with Clarity",
    guide: "オーナーの質問に、短く根拠ある英語で答える練習をする。",
    prompts: [
      "If an owner asks 'Why is GOP below budget?', how do you answer?",
      "What supporting facts would you present without overloading details?",
      "How do you explain actions and timing credibly?",
      "What is your one-sentence summary for the month?"
    ],
    keywords: [
      { en:"one-sentence summary", ja:"一文要約", uses:"Here is the one-sentence summary. / Keep the summary crisp. / Summary should be action-oriented." },
      { en:"supporting facts", ja:"根拠", uses:"Use supporting facts, not opinions. / Provide 2–3 key facts. / Facts should link to actions." },
      { en:"credibility", ja:"信頼性", uses:"Credibility comes from consistency. / Be transparent about risks. / Avoid overpromising." },
      { en:"timing", ja:"タイミング", uses:"Timing of recovery is Q3. / Timing depends on market events. / Provide timing with assumptions." },
      { en:"clarity", ja:"明瞭さ", uses:"Clarity is essential. / Avoid jargon where possible. / Use simple language." }
    ]
  },
  {
    title: "Cash and Working Capital (Simple Explanation)",
    guide: "P&Lと別にキャッシュが動く理由を、運転資本でわかりやすく説明する。",
    prompts: [
      "What items impact cash even if P&L looks stable?",
      "How do receivables and payables affect working capital?",
      "What operational actions improve cash in hotels?",
      "How would you explain cash impact to non-finance teams?"
    ],
    keywords: [
      { en:"cash impact", ja:"キャッシュ影響", uses:"Cash impact differs from profit impact. / Track cash impact weekly. / Cash impact matters for stability." },
      { en:"working capital", ja:"運転資本", uses:"Working capital increased due to receivables. / Working capital control improves liquidity. / Working capital is operational." },
      { en:"receivables", ja:"売掛金", uses:"Receivables increased due to late settlements. / Reduce receivables days. / Receivables management supports cash." },
      { en:"payables", ja:"買掛金", uses:"Payables timing affects cash. / Maintain healthy payables relationships. / Payables planning avoids surprises." },
      { en:"liquidity", ja:"流動性", uses:"Liquidity is stable. / Liquidity risk is low. / Liquidity requires planning." }
    ]
  },
  {
    title: "Month-End Close: Accuracy vs Speed",
    guide: "月次締めで、精度を落とさずにスピードを上げるための会話をする。",
    prompts: [
      "Where do month-end errors usually happen and why?",
      "How do you improve close speed without sacrificing accuracy?",
      "What checks should be mandatory before reporting?",
      "What tasks can be standardized across hotels?"
    ],
    keywords: [
      { en:"month-end close", ja:"月次締め", uses:"Month-end close needs discipline. / Close speed improved with checklists. / Close quality drives trust." },
      { en:"accuracy", ja:"精度", uses:"Accuracy is essential for decisions. / Accuracy issues undermine credibility. / Balance accuracy and speed." },
      { en:"checklist", ja:"チェックリスト", uses:"Checklist prevents omissions. / Use a standardized checklist. / Checklist should be short and mandatory." },
      { en:"reconciliation", ja:"照合", uses:"Reconciliation caught the issue. / Reconcile key accounts. / Reconciliation should be automated where possible." },
      { en:"standard process", ja:"標準プロセス", uses:"Standard process reduces variation. / Build a standard process playbook. / Standardization saves time." }
    ]
  },
  {
    title: "Explaining Forecast Accuracy (What We Got Wrong)",
    guide: "予測が外れた理由を学びとして整理し、改善プロセスを話す。",
    prompts: [
      "Which assumptions were wrong and what new data changed your view?",
      "What signals should you monitor to improve accuracy next time?",
      "How do you separate controllable vs uncontrollable factors?",
      "What is one process change to prevent the same miss?"
    ],
    keywords: [
      { en:"forecast miss", ja:"予測未達", uses:"We had a forecast miss due to demand shift. / Explain the miss clearly. / Use the miss to improve." },
      { en:"signal", ja:"シグナル", uses:"Pickup is a signal. / Web traffic is a signal. / Signals help forecast accuracy." },
      { en:"controllable", ja:"管理可能", uses:"Some factors are controllable. / Focus on controllable actions. / Separate controllable from uncontrollable." },
      { en:"uncontrollable", ja:"不可抗力", uses:"Weather is uncontrollable. / Event cancellations are uncontrollable. / Uncontrollable factors need scenarios." },
      { en:"process change", ja:"プロセス改善", uses:"We will implement a process change. / Process change improves discipline. / Keep process change simple." }
    ]
  },
  {
    title: "Pricing Governance: Who Decides What",
    guide: "価格決定の権限、例外、承認ルールを明確にする会話をする。",
    prompts: [
      "Who has the final say on pricing decisions and why?",
      "What rules prevent over-discounting and protect margin?",
      "How do you document decisions for transparency?",
      "What exceptions are allowed and how are they approved?"
    ],
    keywords: [
      { en:"governance", ja:"統制", uses:"Governance prevents random discounting. / Governance must be clear. / Governance supports consistency." },
      { en:"approval", ja:"承認", uses:"Approval is required for deep discounts. / Approval should be fast. / Approval records ensure transparency." },
      { en:"rule", ja:"ルール", uses:"Rules protect margin. / Make rules simple. / Rules should be enforced consistently." },
      { en:"exception", ja:"例外", uses:"Exceptions must be limited. / Define exceptions clearly. / Exceptions should be logged." },
      { en:"transparency", ja:"透明性", uses:"Transparency improves trust. / Transparency requires documentation. / Transparent decisions reduce conflict." }
    ]
  },
  {
    title: "Competitive Set and Market Share Discussion",
    guide: "競合状況と市場シェアを整理し、価格競争を避ける打ち手を話す。",
    prompts: [
      "What changed in the competitive set this month?",
      "How did competitors price relative to you and why?",
      "What is your market share trend and key risks?",
      "How do you respond without starting a price war?"
    ],
    keywords: [
      { en:"competitive set", ja:"競合群", uses:"Competitive set pricing shifted down. / Monitor the competitive set daily. / Competitive set changes require strategy." },
      { en:"market share", ja:"市場シェア", uses:"Market share declined in weekdays. / Market share improved after repositioning. / Market share is not everything—profit matters." },
      { en:"price war", ja:"価格競争", uses:"Avoid a price war. / Price war destroys value. / Compete on value, not only price." },
      { en:"positioning", ja:"立ち位置", uses:"Positioning must be consistent. / Improve positioning through product value. / Positioning supports rate." },
      { en:"value proposition", ja:"価値提案", uses:"Value proposition justifies price. / Clarify the value proposition. / Value proposition beats discounting long-term." }
    ]
  },
  {
    title: "Quality of Revenue: Net vs Gross Thinking",
    guide: "グロスではなくネット（手数料控除後）で判断する癖をつける会話をする。",
    prompts: [
      "How do you compare net revenue across channels?",
      "Which bookings look good on paper but are weak after costs?",
      "How do you explain revenue quality to non-finance teams?",
      "What metrics should we show weekly to prevent dilution?"
    ],
    keywords: [
      { en:"gross vs net", ja:"グロス/ネット", uses:"Gross looks good but net is weak. / Always check net. / Net reflects reality." },
      { en:"contribution margin", ja:"限界利益", uses:"Contribution margin differs by channel. / Protect contribution margin. / Contribution margin drives decisions." },
      { en:"distribution cost", ja:"流通コスト", uses:"Distribution cost is rising. / Reduce distribution cost with direct growth. / Track distribution cost per booking." },
      { en:"revenue quality", ja:"売上の質", uses:"Revenue quality deteriorated. / Focus on quality, not just quantity. / Improve quality via mix." },
      { en:"dilution", ja:"希薄化", uses:"Dilution came from heavy promotions. / Prevent dilution with rules. / Dilution hurts long-term ADR." }
    ]
  },
  {
    title: "Guest Experience vs Cost: Finding the Line",
    guide: "コスト削減とゲスト体験の境界線を、基準とデータで説明する。",
    prompts: [
      "Which cost cuts are safe and which risk guest dissatisfaction?",
      "How do you evaluate trade-offs objectively?",
      "What service standards must never be compromised?",
      "How do you monitor guest feedback after changes?"
    ],
    keywords: [
      { en:"trade-off", ja:"トレードオフ", uses:"We need a smart trade-off. / Trade-offs should be data-driven. / Avoid false trade-offs." },
      { en:"service standard", ja:"サービス基準", uses:"Service standards must be protected. / Define minimum standards. / Standards should be consistent." },
      { en:"guest feedback", ja:"顧客フィードバック", uses:"Guest feedback stayed stable. / Feedback worsened after staffing cuts. / Monitor feedback weekly." },
      { en:"NPS", ja:"推奨度指標", uses:"NPS dropped slightly. / NPS is a useful signal. / NPS must be interpreted with context." },
      { en:"cost-safe", ja:"安全な削減", uses:"This is a cost-safe change. / Cost-safe actions are preferred. / Not all savings are cost-safe." }
    ]
  },
  {
    title: "Explaining Data Issues and Corrections",
    guide: "データ不備の説明を、原因・影響範囲・再発防止で整理して話す。",
    prompts: [
      "What was wrong with the data and how was it discovered?",
      "What correction did you make and what lines were impacted?",
      "How do you prevent the same issue in the next cycle?",
      "How do you communicate the correction without losing trust?"
    ],
    keywords: [
      { en:"data issue", ja:"データ不備", uses:"We identified a data issue. / Data issue impacted KPIs. / We corrected the data issue promptly." },
      { en:"correction", ja:"修正", uses:"Correction was applied to the report. / We documented the correction. / Correction improved accuracy." },
      { en:"root cause", ja:"根本原因", uses:"Root cause was a mapping error. / Root cause analysis is completed. / Address root cause, not symptoms." },
      { en:"prevention", ja:"再発防止", uses:"Prevention includes validation checks. / Prevention requires process changes. / Prevention is now in place." },
      { en:"trust", ja:"信頼", uses:"Trust depends on transparency. / Protect trust with clear communication. / Trust improves with consistency." }
    ]
  },
  {
    title: "Meeting with International Team (Fusion): Clear Updates",
    guide: "国際チームへ、短く明確に今週の状況と依頼事項を伝える練習をする。",
    prompts: [
      "What is your concise update for this week’s performance?",
      "What support do you need from the international team?",
      "What decisions must be made this week and by whom?",
      "What are the next steps and deadlines?"
    ],
    keywords: [
      { en:"concise update", ja:"簡潔な報告", uses:"Here is a concise update. / Keep it short and clear. / Concise updates save time." },
      { en:"decision", ja:"意思決定", uses:"We need a decision on promotions. / Decision owner is unclear. / Decision timeline is this week." },
      { en:"support", ja:"支援", uses:"We need support on data access. / Support is needed for alignment. / Support will speed execution." },
      { en:"next steps", ja:"次のステップ", uses:"Next steps are defined. / Confirm next steps and owners. / Next steps must be tracked." },
      { en:"deadline", ja:"締切", uses:"Deadline is Friday. / Set a realistic deadline. / Deadline discipline matters." }
    ]
  },

  /* ---- ここから追加（30個に到達させる） ---- */
  {
    title: "Utilities Optimization: Usage vs Rate vs Weather",
    guide: "Utilitiesの差異を、使用量・単価・天候の3点で整理して話す。",
    prompts: [
      "Is the utilities variance driven by usage, tariff rates, or weather factors?",
      "What operational changes can reduce consumption without guest impact?",
      "How do you validate meter data and avoid reporting noise?",
      "What is your monthly forecast approach for utilities going forward?"
    ],
    keywords: [
      { en:"consumption", ja:"使用量", uses:"Consumption increased due to higher load. / We reduced consumption through optimization. / Track consumption by major equipment." },
      { en:"tariff", ja:"料金単価", uses:"Tariff increases drove part of the variance. / Tariff changes should be flagged early. / We need a tariff assumption in forecast." },
      { en:"weather normalization", ja:"天候補正", uses:"Weather normalization explains part of the gap. / Normalize for unusual temperatures. / Weather effects are seasonal." },
      { en:"meter validation", ja:"メーター検証", uses:"Meter validation prevents wrong conclusions. / We cross-checked meter readings. / Validation is required before escalation." },
      { en:"energy saving", ja:"省エネ", uses:"Energy saving actions are prioritized. / Savings should be measurable. / Energy saving must not hurt comfort." }
    ]
  },
  {
    title: "POM Deep Dive: OPEX Repairs vs Planned Maintenance",
    guide: "POMを修繕（OPEX）と計画保全に分け、再発防止を話す。",
    prompts: [
      "Which POM costs are reactive repairs versus planned maintenance?",
      "What is the root cause behind repeated breakdowns?",
      "How do you prioritize maintenance within budget constraints?",
      "What KPIs would you use to track maintenance effectiveness?"
    ],
    keywords: [
      { en:"reactive repair", ja:"突発修繕", uses:"Reactive repairs increased unexpectedly. / Reactive repair work disrupts operations. / We need to reduce reactive repairs." },
      { en:"planned maintenance", ja:"計画保全", uses:"Planned maintenance stabilizes cost. / We need a planned maintenance calendar. / Planned maintenance reduces downtime." },
      { en:"downtime", ja:"停止時間", uses:"Downtime impacted guest satisfaction. / Downtime should be minimized. / Track downtime by asset category." },
      { en:"asset lifecycle", ja:"資産ライフサイクル", uses:"Asset lifecycle planning supports budgeting. / Lifecycle costs must be considered. / We need a lifecycle replacement plan." },
      { en:"prevent recurrence", ja:"再発防止", uses:"We implemented steps to prevent recurrence. / Recurrence prevention is a priority. / Prevent recurrence through SOP and checks." }
    ]
  },
  {
    title: "Payroll Forecasting: Hours, Wage Rate, and Mix",
    guide: "PayrollをHours・時給単価・雇用形態ミックスで分解して話す。",
    prompts: [
      "Is payroll variance driven by hours, wage rate, or staffing mix?",
      "Which departments have the largest controllable opportunities?",
      "How do you link demand signals to roster planning weekly?",
      "What is your action plan to improve payroll accuracy next month?"
    ],
    keywords: [
      { en:"labor hours", ja:"労働時間", uses:"Labor hours exceeded plan in F&B. / Hours should flex with volume. / Track hours per output KPI." },
      { en:"wage rate", ja:"賃金単価", uses:"Wage rate increased due to overtime premium. / Wage rate assumptions must be updated. / Control premium pay where possible." },
      { en:"staffing mix", ja:"雇用形態ミックス", uses:"Staffing mix shifted to more contractors. / Mix changes affect cost stability. / Optimize mix for both cost and quality." },
      { en:"roster accuracy", ja:"シフト精度", uses:"Roster accuracy improved with better forecasts. / Accuracy reduces overstaffing. / We need a weekly roster review." },
      { en:"labor KPI", ja:"人件費KPI", uses:"Use covers per labor hour. / Track rooms cleaned per labor hour. / Labor KPIs support accountability." }
    ]
  },
  {
    title: "GM Letter: Turning Numbers into Executive Narrative",
    guide: "GM Letter向けに、数字→含意→アクションの順で短く語る練習をする。",
    prompts: [
      "What are the three key messages you want the GM to remember?",
      "Which metrics support each message without overloading details?",
      "What actions are already underway and who owns them?",
      "What is the single biggest risk to next month’s outlook?"
    ],
    keywords: [
      { en:"key message", ja:"要点", uses:"The key message is margin pressure from ADR. / Keep the key message consistent. / Lead with the key message." },
      { en:"executive narrative", ja:"経営向けストーリー", uses:"Build an executive narrative from KPIs. / Narrative should be action-oriented. / Narrative must be consistent across teams." },
      { en:"ownership", ja:"オーナー設定", uses:"Ownership is assigned to department heads. / Ownership must be visible. / Lack of ownership delays execution." },
      { en:"risk statement", ja:"リスク記述", uses:"Our risk statement is demand softness. / Risks should be specific and measurable. / Update risks as signals change." },
      { en:"next action", ja:"次の一手", uses:"Next action is to tighten OTA governance. / Next actions must be time-bound. / Next actions should be tracked weekly." }
    ]
  }
];

/* =========================
   ユーティリティ
   ========================= */
function pad2(n){ return String(n).padStart(2,'0'); }
function todayKey(){
  const d = new Date();
  return d.getFullYear()+"-"+pad2(d.getMonth()+1)+"-"+pad2(d.getDate());
}
function escapeHtml(s){
  return String(s)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}
function toast(msg){
  const el = document.getElementById("toast");
  el.textContent = msg;
  el.classList.add("show");
  setTimeout(()=>el.classList.remove("show"), 1400);
}

/* =========================
   Topic選択（自動：日付ベース）＋手動プルダウン上書き
   ========================= */
function topicIndexForDate(dateObj){
  const y = dateObj.getFullYear();
  const m = dateObj.getMonth()+1;
  const d = dateObj.getDate();
  const seed = Number(String(y) + pad2(m) + pad2(d));
  return seed % TOPICS.length;
}
function autoTopicIndex(){
  return topicIndexForDate(new Date());
}
function manualTopicKey(){
  return "speakup_manualTopic_" + todayKey();
}
function getManualTopicIndex(){
  const v = localStorage.getItem(manualTopicKey());
  if (v === null || v === undefined) return null;
  const n = Number(v);
  if (!Number.isFinite(n)) return null;
  if (n < 0 || n >= TOPICS.length) return null;
  return n;
}
function setManualTopicIndex(idx){
  localStorage.setItem(manualTopicKey(), String(idx));
}
function clearManualTopicIndex(){
  localStorage.removeItem(manualTopicKey());
}
function currentTopicIndex(){
  const m = getManualTopicIndex();
  return (m === null) ? autoTopicIndex() : m;
}

/* =========================
   利用/未利用（Let’s speak up! 押下で利用）
   ========================= */
function isUsedToday(){
  const key = "speakup_used_" + todayKey();
  return localStorage.getItem(key) === "1";
}
function markUsedToday(){
  const key = "speakup_used_" + todayKey();
  localStorage.setItem(key, "1");
}

/* =========================
   Topic Select 初期化
   ========================= */
function initTopicSelect(){
  const sel = document.getElementById("topicSelect");
  sel.innerHTML = "";
  TOPICS.forEach((t, i) => {
    const opt = document.createElement("option");
    opt.value = String(i);
    opt.textContent = `Topic ${i+1}: ${t.title}`;
    sel.appendChild(opt);
  });
  sel.addEventListener("change", () => {
    const idx = Number(sel.value);
    if (Number.isFinite(idx) && idx >= 0 && idx < TOPICS.length){
      setManualTopicIndex(idx);
      renderToday();
      toast("Topicを変更しました");
    }
  });
}

/* =========================
   表示
   ========================= */
function renderToday(){
  const idx = currentTopicIndex();
  const topic = TOPICS[idx];

  document.getElementById("dateLabel").textContent = todayKey();
  document.getElementById("statusText").textContent = isUsedToday() ? "利用" : "未利用";
  document.getElementById("topicLabel").textContent = "Topic " + (idx+1);

  // Select reflects current
  const sel = document.getElementById("topicSelect");
  if (sel && sel.value !== String(idx)) sel.value = String(idx);

  // Prompts
  const lines = [];
  lines.push("Let's practice English speaking.");
  lines.push("");
  lines.push("Today's topic: " + topic.title);
  lines.push("");
  lines.push("Guide: " + topic.guide);
  lines.push("");
  lines.push("Rules: Ask me the questions one by one. After each answer, correct my English briefly and suggest a more natural alternative.");
  lines.push("");
  lines.push("Questions:");
  topic.prompts.forEach((q,i)=> lines.push((i+1)+") "+q));
  lines.push("");
  lines.push("Keywords to try using: " + topic.keywords.map(k=>k.en).join(", "));
  lines.push("");
  lines.push("Start with question 1.");
  document.getElementById("promptArea").textContent = lines.join("\n");

  // Keywords list
  const kwList = document.getElementById("kwList");
  kwList.innerHTML = "";
  topic.keywords.forEach(k => {
    const wrap = document.createElement("div");
    wrap.className = "kwItem";
    wrap.innerHTML = `
      <div class="kwTop">
        <div class="kw">${escapeHtml(k.en)} <span class="ja">= ${escapeHtml(k.ja)}</span></div>
        <button class="btnSec" type="button">Notesに追記</button>
      </div>
      <div class="uses"><strong>uses:</strong>\n${escapeHtml(k.uses)}</div>
    `;
    wrap.querySelector("button").addEventListener("click", () => appendKeywordToNotes(k));
    kwList.appendChild(wrap);
  });
}

function appendKeywordToNotes(k){
  const ta = document.getElementById("notesArea");
  const block =
`- ${k.en} = ${k.ja}
uses: ${k.uses}

`;
  ta.value = (ta.value || "") + block;
  toast("Notesに追記しました");
}

function buildChatGPTPrompt(){
  const idx = currentTopicIndex();
  const t = TOPICS[idx];
  const lines = [];
  lines.push("Let's practice English speaking.");
  lines.push("");
  lines.push("Today's topic: " + t.title);
  lines.push("");
  lines.push("Rules: Ask me the questions one by one. After each answer, correct my English briefly and suggest a more natural alternative.");
  lines.push("");
  lines.push("Questions:");
  t.prompts.forEach((q,i)=> lines.push((i+1)+") "+q));
  lines.push("");
  lines.push("Keywords to try using: " + t.keywords.map(k=>k.en).join(", "));
  lines.push("");
  lines.push("Start with question 1.");
  return lines.join("\n");
}

function openChatGPTWithPrompt(prompt){
  const url = "https://chatgpt.com/?prompt=" + encodeURIComponent(prompt);
  window.open(url, "_blank");
}

/* =========================
   History
   ========================= */
function saveHistory(){
  const idx = currentTopicIndex();
  const t = TOPICS[idx];
  const key = "speakup_history";
  const raw = localStorage.getItem(key);
  const list = raw ? JSON.parse(raw) : [];
  list.unshift({
    date: todayKey(),
    topicNo: idx+1,
    title: t.title
  });
  if (list.length > 20) list.length = 20;
  localStorage.setItem(key, JSON.stringify(list));
}
function renderHistory(){
  const raw = localStorage.getItem("speakup_history");
  const list = raw ? JSON.parse(raw) : [];
  const area = document.getElementById("historyArea");
  if (!list.length){
    area.textContent = "履歴はまだありません。";
    return;
  }
  area.textContent = list.map(x => `- ${x.date} / Topic ${x.topicNo} / ${x.title}`).join("\n");
}

/* =========================
   Tabs
   ========================= */
function switchTab(num){
  document.getElementById("viewToday").classList.toggle("active", num===1);
  document.getElementById("viewHistory").classList.toggle("active", num===2);
  document.getElementById("viewSettings").classList.toggle("active", num===3);

  document.getElementById("tab1").classList.toggle("active", num===1);
  document.getElementById("tab2").classList.toggle("active", num===2);
  document.getElementById("tab3").classList.toggle("active", num===3);

  if (num===2) renderHistory();
}

/* =========================
   Midnight auto-refresh
   日付が変わったら Topic/状態 表示更新（手動選択は当日分のみ）
   ========================= */
function scheduleMidnightRefresh(){
  const now = new Date();
  const next = new Date(now);
  next.setHours(24,0,1,0); // 00:00:01
  const ms = next.getTime() - now.getTime();
  setTimeout(() => {
    // 新しい日付になったので、手動選択（前日分）は自然に無効化（キーが変わるため）
    renderToday();
    toast("日付が変わったのでTopicを更新しました");
    scheduleMidnightRefresh();
  }, ms);
}

/* =========================
   Events
   ========================= */
window.addEventListener("load", () => {
  if (!Array.isArray(TOPICS) || TOPICS.length !== 30){
    // 安全策：30固定前提のため、ここは壊さない（本来到達しない）
    console.warn("TOPICS length is expected to be 30.");
  }

  initTopicSelect();
  renderToday();
  scheduleMidnightRefresh();

  document.getElementById("tab1").addEventListener("click", ()=>switchTab(1));
  document.getElementById("tab2").addEventListener("click", ()=>switchTab(2));
  document.getElementById("tab3").addEventListener("click", ()=>switchTab(3));

  document.getElementById("speakBtn").addEventListener("click", () => {
    markUsedToday();
    renderToday();
    saveHistory();
    const prompt = buildChatGPTPrompt();
    openChatGPTWithPrompt(prompt);
    toast("ChatGPTを開きました");
  });

  document.getElementById("copyNotesBtn").addEventListener("click", async () => {
    const text = document.getElementById("notesArea").value || "";
    try{
      if (navigator.clipboard && navigator.clipboard.writeText){
        await navigator.clipboard.writeText(text);
      } else {
        const ta = document.getElementById("notesArea");
        ta.focus();
        ta.select();
        document.execCommand("copy");
        ta.setSelectionRange(0,0);
      }
      toast("コピーしました");
    }catch(e){
      try{
        const ta = document.getElementById("notesArea");
        ta.focus();
        ta.select();
        const ok = document.execCommand("copy");
        ta.setSelectionRange(0,0);
        toast(ok ? "コピーしました" : "コピー失敗（権限/ブラウザ設定）");
      }catch(_){
        toast("コピー失敗（権限/ブラウザ設定）");
      }
    }
  });

  document.getElementById("clearNotesBtn").addEventListener("click", () => {
    document.getElementById("notesArea").value = "";
    toast("クリアしました");
  });

  document.getElementById("resetAllBtn").addEventListener("click", () => {
    if (!confirm("全データを初期化します。よろしいですか？")) return;
    const keys = [];
    for (let i=0;i<localStorage.length;i++){
      const k = localStorage.key(i);
      if (k && k.startsWith("speakup_")) keys.push(k);
    }
    keys.forEach(k => localStorage.removeItem(k));
    initTopicSelect();
    renderToday();
    renderHistory();
    toast("初期化しました");
  });
});
</script>
</body>
</html>
